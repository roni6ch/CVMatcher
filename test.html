<!DOCTYPE html>
<html>
<head>
    <title>Hello Bubble Chart</title>
    <meta charset="utf-8">

    <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600,200italic,600italic&subset=latin,vietnamese'
          rel='stylesheet' type='text/css'>

    <script src="http://phuonghuynh.github.io/js/bower_components/jquery/dist/jquery.min.js"></script>
    <script src="http://phuonghuynh.github.io/js/bower_components/d3/d3.min.js"></script>
    <script src="http://phuonghuynh.github.io/js/bower_components/d3-transform/src/d3-transform.js"></script>
    <script src="js/d3-transform-animation.js"></script>
    <style>
        .bubbleChart {
            min-width: 100px;
            max-width: 700px;
            height: 700px;
            margin: 0 auto;
        }

        .bubbleChart svg {
            background: #000000;
        }
    </style>
</head>
<body style="background: #000000">
<div class="bubbleChart"/>
</body>
</html>

<script>
    $(document).ready(function () {
        var skills = [];
        jQuery.ajax ({
            url: "https://cvmatcher.herokuapp.com/getMatchingObject",
            type: "POST",
            data: JSON.stringify({
                matching_object_id: "5745af8ced9bf303001f1167",
                matching_object_type: "cv"
            }),
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            success: function (data) {

                var skillsFromJson = data[0].formula.matching_requirements.details;

                $.each(skillsFromJson, function (k, v) {
                    skills.push({
                        text: v.name,
                        count: v.grade
                    });
                });

                var bubbleChart = new d3.svg.BubbleChart({
                    supportResponsive: true,
                    //container: => use @default
                    size: 600,
                    //viewBoxSize: => use @default
                    innerRadius: 600 / 3.5,
                    //outerRadius: => use @default
                    radiusMin: 50,
                    //radiusMax: use @default
                    //intersectDelta: use @default
                    //intersectInc: use @default
                    //circleColor: use @default
                    data: {
                        items: skills,
                        eval: function (item) {
                            return item.count;
                        },
                        classed: function (item) {
                            return item.text.split(" ").join("");
                        }
                    },
                    plugins: [
                        {
                            name: "central-click",
                            options: {
                                text: "(See more detail)",
                                style: {
                                    "font-size": "12px",
                                    "font-style": "italic",
                                    "font-family": "Source Sans Pro, sans-serif",
                                    //"font-weight": "700",
                                    "text-anchor": "middle",
                                    "fill": "white"
                                },
                                attr: {dy: "65px"},
                                centralClick: function () {
                                    console.log("Here is more details!!");
                                }
                            }
                        },
                        {
                            name: "lines",
                            options: {
                                format: [
                                    {// Line #0
                                        textField: "count",
                                        classed: {count: true},
                                        style: {
                                            "font-size": "28px",
                                            "font-family": "Source Sans Pro, sans-serif",
                                            "text-anchor": "middle",
                                            fill: "white"
                                        },
                                        attr: {
                                            dy: "0px",
                                            x: function (d) {
                                                return d.cx;
                                            },
                                            y: function (d) {
                                                return d.cy;
                                            }
                                        }
                                    },
                                    {// Line #1
                                        textField: "text",
                                        classed: {text: true},
                                        style: {
                                            "font-size": "14px",
                                            "font-family": "Source Sans Pro, sans-serif",
                                            "text-anchor": "middle",
                                            fill: "white"
                                        },
                                        attr: {
                                            dy: "20px",
                                            x: function (d) {
                                                return d.cx;
                                            },
                                            y: function (d) {
                                                return d.cy;
                                            }
                                        }
                                    }
                                ],
                                centralFormat: [
                                    {// Line #0
                                        style: {"font-size": "50px"},
                                        attr: {}
                                    },
                                    {// Line #1
                                        style: {"font-size": "30px"},
                                        attr: {dy: "40px"}
                                    }
                                ]
                            }
                        }]
                });
            }
        });
    });
</script>